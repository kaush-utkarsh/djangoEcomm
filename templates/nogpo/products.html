{% extends "nogpo/base.html" %} {% block content %}
<script>
jQuery(function($) {
    "use strict";
    var socialItems = $('.social-widgets .items .item');
    var counter = 0;
    socialItems.each(function() {
        counter++;
        var itemclass = "item-0" + counter;
        $(this).addClass(itemclass)
    });
});
</script>

<section class="container content">
    <div class="row">
        <!-- Left column -->
        <aside class="col-sm-4 col-md-3 col-lg-3 content-aside">
            <div class="block block-layered-nav">
                <div class="block-title">
                    <strong><span>Shop By</span></strong>
                </div>
                <div class="block-content">
                    <p class="block-subtitle">Shopping Options</p>
                    <p><strong>Category</strong></p>
                    <dd>
                        <ul class="simple-list">
                            {% for item in res %}
                            <li>– &nbsp;
                                <a href="http://demo.ethemeuk.com/megatron/magento/demo/index.php/women.html?___store=fluidchat&amp;cat=138&amp;mode=grid">{{ item.name }}</a>
                            </li>
                            {% endfor %}
                        </ul>
                    </dd>
                    <p><strong>Price</strong></p>
                    <dd>
                        <ul class="simple-list">
                            <li>– &nbsp;
                                <a href="http://demo.ethemeuk.com/megatron/magento/demo/index.php/women.html?___store=fluidchat&amp;mode=grid&amp;price=-1000"><span class="price">$0.00</span> - <span class="price">$999.99</span></a> (23)
                            </li>
                            <li>– &nbsp;
                                <a href="http://demo.ethemeuk.com/megatron/magento/demo/index.php/women.html?___store=fluidchat&amp;mode=grid&amp;price=1000-"><span class="price">$1,000.00</span> and above</a> (3)
                            </li>
                        </ul>
                    </dd>
                    <p><strong>Color</strong></p>
                    <dd></dd>
                    <script type="text/javascript">
                    decorateDataList('narrow-by-list')
                    </script>
                </div>
            </div>
            <!-- Shop by categories -->
            <div class="block block-navigation">
                <div class="block-title">
                    <strong><span>SHOP BY CATEGORIES</span></strong>
                </div>
                <div class="block-content">
                    <ul class="expander-list">
                        {% for item in res %}
                        <li class="level{{ item.id }} nav-{{ item.id }} parent">
                            <span class="name">
            <span class="expander">-</span>
                            <a href="http://demo.ethemeuk.com/megatron/magento/demo/index.php/women.html">{{ item.name }}</a>
                            </span>
                            <ul class="level{{ item.id }}">
                                {% for item_child in item.child %}
                                <li class="level1 nav-{{ item_child.id }} parent">
                                    <span class="name">
                <span class="expander">-</span>
                                    <a href="http://demo.ethemeuk.com/megatron/magento/demo/index.php/women/dresses.html">
                                        <span class="glyphicon glyphicon-asterisk"></span>{{ item_child.name }}
                                    </a>
                                    </span>
                                </li>
                                {% endfor %}
                            </ul>
                            {% endfor %}
                    </ul>
                </div>
            </div>
            <!-- //end Shop by categories -->
            <!-- Products list -->
            <div class="section-divider"></div>
        </aside>
        <!--Content -->
        <section class="col-sm-8 col-md-9 col-lg-9 content-center">
            <form id="submit_query" class="form-inline">
                <input id="submit_input" type="text" class="input-medium search-query">
                <button type="submit" class="btn btn-lg btn-success">Search</button>
            </form>
            <script type="text/javascript">
                var url = window.location.href;
                console.log('url', url)
                if(url.indexOf('search=') != -1) {
                    console.log('if women')
                    var query = url.split('?')[1].split('=')[1];
                    jQuery("#submit_input").val(query)
                    jQuery.ajax({
                        url: "/nogpo/search/",
                        data: {
                            query: query
                        }
                    }).done(function(response){
                        jQuery('#products_list').empty()
                        var productLists = jQuery("#products_list")
                        var productTemplate = '';

                        for (var i = 0; i < response.length; i += 2) {
                            if(response[i]) {
                                var templateTwoImages = '<div class="product-preview new"><div class="preview animate scale hover-slide"><a href="/product/'+response[i].id+'" class="preview-image"><img src="http://www.mendell.com/images/Orthopedics.jpg" class="img-responsive  animate scale product-retina" data-image2x="http://www.mendell.com/images/Orthopedics.jpg" alt="'+response[i].name+'"><img src="http://www.mendell.com/images/Orthopedics.jpg" class="product-retina img-responsive" data-image2x="http://www.mendell.com/images/Orthopedics.jpg" alt="'+response[i].name+'"></a><ul class="product-controls-list right hide-right"><li class="top-out-small"></li><li><a class="circle" href="#" onclick="ajaxWishlist([[add_to_wishlist_url]],'+response[i].id+');return false;"><span class="icon-heart"></span></a></li><li><a class="circle" href="#" onclick="ajaxCompare(null,'+response[i].id+');return false;"><span class="icon-justice"></span></a></li><li><a class="cart" onclick="setLocationAjax(null,'+response[i].id+')"><span class="icon-basket"></span></a></li></ul><a href="[[unknown_url]]" class="quick-view hidden-xs"><span class="icon-zoom-in-2 cursor-hand" onclick="showOptions('+response[i].id+')"></span> Quick View</a></div><h3 class="title"><a href="[[product_url]]" title="'+response[i].name+'">'+response[i].name+'</a></h3><div class="price-box"><span class="regular-price" id="product-price-'+response[i].id+'"><span class="price">'+response[i].price+'</span></span></div></div>'
                                productLists.append(templateTwoImages)
                            }

                            if(response[i+1]) {
                                var templateOneImage = '<div class="product-preview new"><div class="preview animate scale"><a href="/product/'+response[i+1].id+'" class="preview-image"><img src="http://3.imimg.com/data3/UN/KI/MY-4527123/orthopedic-implants-250x250.jpg" class="product-retina img-responsive" data-image2x="http://3.imimg.com/data3/UN/KI/MY-4527123/orthopedic-implants-250x250.jpg" alt="'+response[i+1].name+'"></a><ul class="product-controls-list right hide-right"><li class="top-out-small"></li><li><a class="circle" href="#" onclick="ajaxWishlist([[add_to_wishlist_url]],'+response[i+1].id+');return false;"><span class="icon-heart"></span></a></li><li><a class="circle" href="#" onclick="ajaxCompare(null,'+response[i+1].id+');return false;"><span class="icon-justice"></span></a></li><li><a class="cart" onclick="setLocationAjax(null,'+response[i+1].id+')"><span class="icon-basket"></span></a></li></ul><a href="[[unknown_url]]" class="quick-view hidden-xs"><span class="icon-zoom-in-2 cursor-hand" onclick="showOptions('+response[i+1].id+')"></span> Quick View</a></div><h3 class="title"><a href="[[product_url]]" title="'+response[i+1].name+'">'+response[i+1].name+'</a></h3><div class="price-box"><span class="regular-price" id="product-price-'+response[i+1].id+'"><span class="price">'+response[i+1].price+'</span></span></div></div>'
                                productLists.append(templateOneImage)
                            }
                        }
                    })
                }

                jQuery("#submit_query").submit(function(evt) {
                    evt.preventDefault()
                    var query = jQuery("#submit_input").val();
                    var urlString = window.location.href;
                    console.log(urlString)
                    if(urlString.indexOf('search=') == -1) {
                        console.log('if working')
                        urlString = urlString + '?search=' + query
                    } else {
                        console.log('else working')
                        urlString = urlString.replace(/search=\w+/, "search="+query);
                    }
                    window.location = urlString
                })
            </script>
            <br>
            <br>
            <br>
            <br>
            <div class="products-list products-list-small row" id="products_list">
            </div>
            <div class="clearfix"></div>
    </div>
    </div>
    </section>
    </div>
</section>
{% endblock %}
